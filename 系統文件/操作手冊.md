# Markdown 轉 Docx 工具 - 操作手冊

## 1. 介面總覽

本工具介面分為 **側邊欄 (設定區)** 與 **主畫面 (標籤頁式輸入區)**。

### 側邊欄設定
*   **自動生成目錄 (TOC)**：勾選後，Word 第一頁將會是目錄。
*   **支援數學公式**：若文中有 LaTeX 公式請勾選。
*   **合併所有檔案**：若上傳多個 `.md` 檔，勾選此項可將其合併為一個 `.docx`。
*   **文件屬性 (Metadata)**：設定 Word 的標題、作者與日期資訊。
    *   此設定適用於所有轉換模式（上傳檔案或貼上文字）。
    *   預設摺疊，點擊展開即可設定。
*   **樣式範本**：
    *   **使用內建範本**：從 `templates` 資料夾選取。
    *   **上傳自訂範本**：上傳您公司或個人的標準 Word 範本檔。

### 主畫面標籤頁
*   **📁 上傳檔案**：上傳 `.md` 檔案進行轉換，支援批次上傳與合併。
*   **📝 貼上文字**：直接貼上 Markdown 內容，適合快速轉換少量文字。

## 2. 操作流程

### 模式 A：上傳檔案轉換

#### 步驟一：選擇範本
於側邊欄選擇您要使用的樣式。
*   若選擇「自訂範本」並上傳檔案，主畫面上方會出現 **「🎨 查看樣式詳情」** 區塊。
*   點擊展開可檢查該範本的標題 (Heading 1-3)、內文 (Normal) 等字型設定。

#### 步驟二：上傳 Markdown 檔案
將您的 `.md` 檔案拖曳至「📁 上傳檔案」標籤頁的上傳區。支援批次上傳。

#### 步驟三：調整順序 (僅合併模式)
若您勾選了「合併所有檔案」，且上傳了多個檔案，會出現 **「🔀 調整合併順序」** 選單。
*   請依照您希望的章節順序，在選單中確認檔案排列。
*   若順序有誤，可刪除選單項目後重新依序加入。

#### 步驟四：開始轉換
點擊 **「🚀 開始轉換」** 按鈕。
*   系統會自動解析 Mermaid 圖表並下載。
*   單個檔案：直接出現 **「📥 下載 Word 文件」** 按鈕。
*   多個檔案：出現 **「📥 下載結果 (ZIP)」** 按鈕。

### 模式 B：貼上文字轉換

#### 步驟一：切換至貼上模式
點擊主畫面的 **「📝 貼上文字」** 標籤頁。

#### 步驟二：輸入內容
*   **輸出檔名**：設定想要的檔案名稱（不需輸入副檔名）。
*   **Markdown 內容**：直接貼上或輸入您的 Markdown 文字。

#### 步驟三：開始轉換
點擊 **「🚀 開始轉換」** 按鈕。
*   完成後會出現 **「📥 下載 Word 文件」** 按鈕。

## 3. 常見問題

### Q: 為什麼目錄沒有顯示？
A: 請在 Word 中對目錄區域（通常在第一頁）按 **右鍵 -> 更新功能變數 -> 更新整個目錄**。這是 Word 的安全性限制，通常不允許自動刷新。

### Q: 流程圖顯示亂碼或無法下載？
A: 請確認您的 Mermaid 語法正確。您可以在線上的 Mermaid Live Editor 測試語法是否有效。

### Q: 如何製作自訂範本？
A: 您可以使用 Pandoc 匯出預設範本：`pandoc --print-default-data-file reference.docx > my_template.docx`，然後在 Word 中修改該檔案的「樣式」設定 (例如修改 "Heading 1" 的字型與顏色) 並儲存即可。

### Q: 貼上文字模式的文件屬性在哪裡設定？
A: 側邊欄的「📝 文件屬性 (Metadata)」適用於所有模式。點擊展開即可設定標題、作者、日期。
